services:
  searxng-valkey:
    image: valkey/valkey:8-alpine
    container_name: searxng-valkey
    restart: always
    volumes:
      - searxng-valkey-data:/data
    command: ["valkey-server", "--save", "30", "1", "--loglevel", "warning"]
    networks:
      - searxng

  searxng:
    image: searxng/searxng:latest
    container_name: searxng
    restart: always
    ports:
      - "8080:8080"
    volumes:
      - searxng-config:/etc/searxng
      - searxng-cache:/var/cache/searxng
    environment:
      - SEARXNG_BASE_URL=https://searxng.internal.crussell.io/
    depends_on:
      - searxng-valkey
    networks:
      - searxng

volumes:
  searxng-valkey-data:
  searxng-config:
  searxng-cache:

networks:
  searxng:
    driver: bridge

